<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="google-adsense-account" content="ca-pub-9860497702017992">
<title>Unique Collection4u — Curated Deals & Expert Picks</title>

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<style>
  :root{
    --blue:#0e66d1;
    --blue-dark:#0a4c92;
    --muted:#6b7280;
    --card-bg: #ffffff;
    --page-bg: #f6f9ff;
    --radius: 12px;
  }

  html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial,sans-serif;background:var(--page-bg);color:#111}
  /* Header */
  header{background:linear-gradient(90deg,var(--blue),var(--blue-dark));color:#fff;position:sticky;top:0;z-index:1400;box-shadow:0 4px 18px rgba(12,40,80,0.12)}
  .topbar{max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;padding:12px 20px}
  .brand{display:flex;align-items:center;gap:12px}
  .brand img{width:44px;height:44px;border-radius:8px;background:#fff;padding:4px;box-sizing:border-box}
  .brand h1{margin:0;font-size:18px;font-weight:700;letter-spacing:-0.2px}
  nav.primary{display:flex;gap:14px;align-items:center}
  nav.primary a{color:#fff;text-decoration:none;font-weight:600;padding:6px 8px;border-radius:8px;transition:background .15s}
  nav.primary a:hover{background:rgba(255,255,255,0.08)}

  /* Search area */
  .search-wrap{max-width:1200px;margin:12px auto;padding:12px 20px;display:flex;gap:12px;align-items:center;justify-content:space-between}
  .search-left{display:flex;gap:12px;align-items:center;flex:1}
  .search-input{flex:1;display:flex;gap:0;box-shadow:0 6px 20px rgba(12,40,80,0.06);border-radius:12px;overflow:hidden;background:#fff}
  .search-input input{flex:1;padding:12px 14px;border:0;outline:none;font-size:15px}
  .search-input button{border:0;background:var(--blue);color:#fff;padding:10px 16px;font-weight:700;cursor:pointer}
  .search-meta{color:var(--muted);font-size:14px;min-width:220px;text-align:right}

  /* Social */
  .socials{display:flex;gap:10px;align-items:center}
  .socials a{color:#fff;font-size:18px;text-decoration:none;padding:6px;border-radius:8px}
  .socials a:hover{background:rgba(255,255,255,0.08)}

  /* Page content */
  .wrap{max-width:1200px;margin:0 auto;padding:20px}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:18px}
  .card{background:var(--card-bg);border-radius:var(--radius);padding:12px;box-shadow:0 8px 28px rgba(11,35,80,0.06);display:flex;flex-direction:column;min-height:340px}
  .thumb{height:200px;border-radius:8px;overflow:hidden;background:#f2f6ff;display:flex;align-items:center;justify-content:center}
  .thumb img{width:100%;height:100%;object-fit:contain;display:block}
  .name{margin:12px 0 6px;font-weight:700;font-size:14px;line-height:1.25;color:#0b263f;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;cursor:pointer}
  .name.expanded{display:block;max-height:none;white-space:normal}
  .cta{margin-top:auto}
  .cta a{display:inline-block;width:100%;text-align:center;padding:10px;border-radius:10px;background:var(--blue);color:#fff;text-decoration:none;font-weight:700}
  .cta a:hover{background:var(--blue-dark)}
  .meta{font-size:13px;color:var(--muted);margin-bottom:6px}

  /* Pagination */
  .pagination{display:flex;justify-content:center;gap:8px;margin:26px 0}
  .pagination button{padding:8px 12px;border-radius:8px;border:0;background:var(--blue);color:#fff;cursor:pointer}
  .pagination button[disabled]{background:#cbd5e1;color:#475569;cursor:default}

  /* Footer */
  footer{background:linear-gradient(90deg,var(--blue-dark),var(--blue));color:#fff;padding:18px;margin-top:30px}
  footer .inner{max-width:1200px;margin:0 auto;display:flex;justify-content:space-between;align-items:center}
  footer p{margin:0;font-size:14px}
  footer .socials{gap:14px}

  @media(max-width:800px){
    .search-meta{display:none}
    nav.primary{display:none}
    .wrap{padding:12px}
  }
</style>
</head>
<body>

<header>
  <div class="topbar">
    <div class="brand">
      <!-- small logo placeholder -->
      <img src="https://via.placeholder.com/64x64.png?text=UC" alt="Unique Collection4u">
      <div>
        <h1>Unique Collection4u</h1>
        <div style="font-size:12px;color:rgba(255,255,255,0.9);margin-top:2px">Curated deals & affiliate picks</div>
      </div>
    </div>

    <nav class="primary">
      <a href="index.html">Home</a>
      <a href="about.html">About</a>
      <a href="contact.html">Contact</a>
      <a href="privacy.html">Privacy</a>
    </nav>

    <div class="socials">
      <a href="https://discord.gg/Aa9a6XHwZz" target="_blank" title="Discord"><i class="fab fa-discord"></i></a>
      <a href="https://www.youtube.com/@uniquecollection01" target="_blank" title="YouTube"><i class="fab fa-youtube"></i></a>
      <a href="https://instagram.com/uniquecollection0555" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a>
      <a href="https://facebook.com/UniqueCollection0555" target="_blank" title="Facebook"><i class="fab fa-facebook"></i></a>
      <a href="https://whatsapp.com/channel/0029VbBdg1zGk1FoG5cHlR2J" target="_blank" title="WhatsApp"><i class="fab fa-whatsapp"></i></a>
    </div>
  </div>
</header>

<div class="search-wrap">
  <div class="search-left">
    <div class="search-input" role="search">
      <input id="searchInput" type="search" placeholder="Search products (try: watch, cricket, kitchen)"/>
      <button id="searchBtn">Search</button>
    </div>
  </div>
  <div class="search-meta" id="searchMeta">Showing products</div>
</div>

<main class="wrap">
  <div id="grid" class="grid"></div>
  <div class="pagination" id="pagination"></div>
</main>

<footer>
  <div class="inner">
    <p>&copy; 2025 Unique Collection4u</p>
    <div class="socials">
      <a href="https://discord.gg/Aa9a6XHwZz" target="_blank" title="Discord"><i class="fab fa-discord"></i></a>
      <a href="https://www.youtube.com/@uniquecollection01" target="_blank" title="YouTube"><i class="fab fa-youtube"></i></a>
      <a href="https://instagram.com/uniquecollection0555" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a>
      <a href="https://facebook.com/UniqueCollection0555" target="_blank" title="Facebook"><i class="fab fa-facebook"></i></a>
      <a href="https://whatsapp.com/channel/0029VbBdg1zGk1FoG5cHlR2J" target="_blank" title="WhatsApp"><i class="fab fa-whatsapp"></i></a>
    </div>
  </div>
</footer>

<script>
/*
  Full working script:
  - Loads products.json (array of objects with fields: name,img,alt,link)
  - Filters (live + search button)
  - Pagination
  - Truncate then expand on click [more]/[less]
  - Fallbacks for missing image/name/link
  - Safe for GitHub Pages (cache-bust)
*/

const GRID = document.getElementById('grid');
const PAG = document.getElementById('pagination');
const SEARCH = document.getElementById('searchInput');
const SEARCH_BTN = document.getElementById('searchBtn');
const META = document.getElementById('searchMeta');

let allProducts = [];
let filtered = [];
let currentPage = 1;
const PER_PAGE = 12;

// small helper to safe-string
function s(v){ return (v||'').toString(); }

// load products.json (cache-bust to avoid stale cached file)
async function loadProducts(){
  try{
    const res = await fetch('products.json?t=' + Date.now(), {cache: 'no-store'});
    let data = await res.json();

    // if not array, attempt to coerce
    if(!Array.isArray(data)){
      data = Array.isArray(data.items) ? data.items : Object.values(data);
    }

    // filter out empty / invalid entries
    allProducts = data.filter(p => p && s(p.name).trim() !== '' && s(p.link).trim() !== '');
    // normalize fields
    allProducts = allProducts.map(p => ({
      name: s(p.name),
      img: s(p.img),
      alt: s(p.alt) || s(p.name),
      link: s(p.link)
    }));

    // initial render: consider ?search= and &page=
    const params = new URLSearchParams(location.search);
    const q = params.get('search') || '';
    const p = parseInt(params.get('page')) || 1;
    SEARCH.value = q;
    currentPage = p || 1;

    applyFilterAndRender();
  }catch(err){
    console.error('Failed to load products.json', err);
    GRID.innerHTML = '<div style="grid-column:1/-1;color:#64748b;text-align:center;padding:40px">Failed to load products.json — check file and path.</div>';
  }
}

// apply filter from search box and re-render
function applyFilterAndRender(){
  const q = SEARCH.value.trim().toLowerCase();
  if(q){
    filtered = allProducts.filter(p => p.name.toLowerCase().includes(q));
  } else {
    filtered = allProducts.slice();
  }

  // if page param exists in URL, keep currentPage else reset to 1
  const urlParams = new URLSearchParams(location.search);
  if(!urlParams.has('page')) currentPage = 1;

  // clamp currentPage
  const totalPages = Math.max(1, Math.ceil(filtered.length / PER_PAGE));
  if(currentPage < 1) currentPage = 1;
  if(currentPage > totalPages) currentPage = totalPages;

  updateMeta();
  renderPage(currentPage);
  updateURL();
}

function updateMeta(){
  const total = filtered.length;
  const showingFrom = Math.min( (currentPage-1)*PER_PAGE + 1, total || 0 );
  const showingTo = Math.min(currentPage*PER_PAGE, total);
  META.textContent = total ? `Showing ${showingFrom}-${showingTo} of ${total} products` : 'No products found';
}

// render single page
function renderPage(page){
  GRID.innerHTML = '';
  const start = (page -1) * PER_PAGE;
  const rows = filtered.slice(start, start + PER_PAGE);

  if(rows.length === 0){
    GRID.innerHTML = '<div style="grid-column:1/-1;color:#64748b;text-align:center;padding:40px">No products to display.</div>';
    PAG.innerHTML = '';
    return;
  }

  rows.forEach((p, i) => {
    const idx = start + i;
    const card = document.createElement('div');
    card.className = 'card';

    // safe image fallback
    const imgSrc = p.img && p.img.trim() ? p.img : 'https://via.placeholder.com/600x400?text=No+Image';

    // create inner HTML
    card.innerHTML = `
      <div class="thumb"><img loading="lazy" src="${escapeHtml(imgSrc)}" alt="${escapeHtml(p.alt||p.name)}" onerror="this.src='https://via.placeholder.com/600x400?text=No+Image'"></div>
      <div class="meta">${escapeHtml(p.alt || '')}</div>
      <div class="name" id="nm${idx}">${escapeHtml(truncate(p.name,160))}</div>
      <div class="cta">
        <a href="${escapeAttr(p.link)}" target="_blank" rel="noopener">Shop Now</a>
      </div>
    `;

    GRID.appendChild(card);

    // if name length exceeds threshold, add clickable expand control
    const fullName = p.name;
    const nameEl = card.querySelector('.name');
    if(fullName.length > 72){
      // show truncated preview by default using CSS clamp; append [more]
      const more = document.createElement('span');
      more.style.color = '#0e66d1';
      more.style.marginLeft = '6px';
      more.style.fontWeight = '700';
      more.style.cursor = 'pointer';
      more.textContent = ' [more]';
      more.onclick = () => toggleExpand(nameEl, more, fullName);
      nameEl.textContent = truncate(fullName,160); // ensure trimmed display
      nameEl.appendChild(more);
    } else {
      nameEl.textContent = fullName;
    }
  });

  renderPagination();
}

// pagination rendering
function renderPagination(){
  const totalPages = Math.max(1, Math.ceil(filtered.length / PER_PAGE));
  PAG.innerHTML = '';
  if(totalPages <= 1) return;

  // prev
  const prev = document.createElement('button');
  prev.textContent = 'Prev';
  prev.disabled = currentPage === 1;
  prev.onclick = () => { currentPage--; applyFilterAndRender(); };
  PAG.appendChild(prev);

  // page buttons (show a few around current)
  const maxButtons = 7;
  let start = Math.max(1, currentPage - Math.floor(maxButtons/2));
  let end = Math.min(totalPages, start + maxButtons - 1);
  if(end - start < maxButtons -1) start = Math.max(1, end - maxButtons + 1);

  for(let i = start; i <= end; i++){
    const btn = document.createElement('button');
    btn.textContent = i;
    if(i === currentPage){ btn.disabled = true; btn.setAttribute('aria-current','page'); }
    btn.onclick = (() => { const p = i; return () => { currentPage = p; applyFilterAndRender(); }; })();
    PAG.appendChild(btn);
  }

  // next
  const next = document.createElement('button');
  next.textContent = 'Next';
  next.disabled = currentPage === totalPages;
  next.onclick = () => { currentPage++; applyFilterAndRender(); };
  PAG.appendChild(next);
}

// expand/collapse name
function toggleExpand(nameEl, controlEl, full){
  const expanded = nameEl.classList.toggle('expanded');
  if(expanded){
    nameEl.textContent = full;
    controlEl.textContent = ' [less]';
    nameEl.appendChild(controlEl);
  } else {
    nameEl.textContent = truncate(full,160);
    controlEl.textContent = ' [more]';
    nameEl.appendChild(controlEl);
  }
}

// helper: truncate to certain chars with ellipsis
function truncate(str, max){
  if(!str) return '';
  return str.length > max ? str.slice(0, max-1).trim() + '…' : str;
}

// safe escaping for HTML text nodes
function escapeHtml(s){
  return (s||'').replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;');
}
// safe escaping for attributes (very simple)
function escapeAttr(s){
  return (s||'').replaceAll('"','%22').replaceAll("'",'%27');
}

// update URL (query params) to preserve search + page (no 404 on GitHub Pages)
function updateURL(){
  const params = new URLSearchParams();
  const q = SEARCH.value.trim();
  if(q) params.set('search', q);
  if(currentPage && currentPage > 1) params.set('page', currentPage);
  const newUrl = location.pathname + (params.toString() ? ('?' + params.toString()) : '');
  history.replaceState(null, '', newUrl);
}

// live search behavior
let typingTimer;
SEARCH.addEventListener('input', () => {
  clearTimeout(typingTimer);
  typingTimer = setTimeout(() => {
    currentPage = 1;
    applyFilterAndRender();
  }, 300);
});
SEARCH.addEventListener('keydown', (e) => {
  if(e.key === 'Enter'){ e.preventDefault(); currentPage = 1; applyFilterAndRender(); }
});
SEARCH_BTN.addEventListener('click', () => { currentPage = 1; applyFilterAndRender(); });

// initialize
loadProducts();
</script>
